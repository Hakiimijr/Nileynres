<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NILEYN School - Multi-Student Receipt</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { background: #f0f4f8; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
.container { max-width: 900px; margin: 30px auto; }
.student-box { padding: 15px; border-radius: 12px; margin-bottom: 15px; color: #fff; display: flex; justify-content: flex-start; align-items: center; gap: 15px; flex-wrap: nowrap; }
.student-name, .student-class, .student-parent { font-weight: bold; padding: 5px 10px; border-radius: 8px; }
.student-parent { font-style: italic; font-weight: bold; }
.total-text { margin-top: 20px; text-align: center; font-size: 20px; font-weight: bold; padding: 15px; border-radius: 10px; background-color: #ffe4c4; color: #0d6efd; }
.btn-generate, .btn-print { display: block; margin: 15px auto 0; background: #0d6efd; border: none; color: #fff; font-weight: bold; transition: background 0.3s; }
.btn-generate:hover, .btn-print:hover { background: #074bb5; }
.receipt-footer { margin-top: 30px; padding: 10px; text-align: center; font-size: 14px; color: #555; border-top: 1px dashed #0d6efd; }

/* Print styling for A5 */
@media print {
  @page {
    size: A5 portrait;
    margin: 10mm;
  }
  body { background: #fff; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
  .btn-print, .btn-generate, form { display: none; }
  .student-box { 
    color: #000 !important; 
    background-color: #f2f2f2 !important; 
    border: 1px solid #000 !important; 
    font-size: 12px; 
    padding: 10px !important;
  }
  .total-text { 
    color: #000 !important; 
    background-color: #ccc !important; 
    border: 1px solid #000 !important; 
    font-size: 14px; 
    padding: 10px !important;
  }
  .receipt-footer { color: #000 !important; border-top: 1px solid #000 !important; font-size: 12px; }
}
</style>
</head>
<body>

<div class="container">
<h2 class="text-center mb-4">NILEYN School - Payment Receipt</h2>

<form id="studentForm">
  <div class="mb-3 border p-3 rounded">
    <label class="form-label">Parent/Guardian Name</label>
    <input type="text" class="form-control" id="parentName" placeholder="Enter parent name" required>
  </div>

  <!-- Discount Input -->
  <div class="mb-3 border p-3 rounded">
    <label class="form-label">Discount Amount (optional)</label>
    <input type="number" class="form-control" id="discountAmount" placeholder="Enter discount amount">
  </div>

  <div id="studentInputs"></div>
  <button type="submit" class="btn btn-generate w-100">Generate Receipt</button>
</form>

<div id="receiptOutput" class="mt-4 d-none">
  <h4 class="text-center text-primary mb-3">Payment Receipt</h4>
  <div id="studentsList"></div>
  <div class="total-text" id="totalText">*789*123456*0#</div>
  <button class="btn btn-print w-50" id="printButton" onclick="printReceipt()">Print Receipt</button>
  <div class="receipt-footer">
    Thank you for your payment. NILEYN Primary & Secondary School - Excellence in Education.
  </div>
</div>
</div>

<script>
const maxStudents = 7;
const classPrices = {
  "1aad":8,"2aad":8,"3aad":8,"4aad":8,
  "5aad":12,"6aad":12,"7aad":12,"8aad":12,
  "F1":19,"F2":19,"F3":19,"F4":19
};
const colors = ['#0d6efd','#6610f2','#198754','#fd7e14','#dc3545','#20c997','#0dcaf0'];

const studentInputsDiv = document.getElementById('studentInputs');

// Generate student input fields
for(let i=1; i<=maxStudents; i++){
  const div = document.createElement('div');
  div.className = "mb-3 border p-3 rounded";
  div.innerHTML = `
    <label class="form-label">Student ${i} Name</label>
    <input type="text" class="form-control student-name-input" placeholder="Enter student name" ${i===1?'required':''}>
    <label class="form-label mt-2">Class</label>
    <select class="form-select class-select" ${i===1?'required':''}>
      <option value="">Select Class</option>
      <option value="1aad">1aad</option>
      <option value="2aad">2aad</option>
      <option value="3aad">3aad</option>
      <option value="4aad">4aad</option>
      <option value="5aad">5aad</option>
      <option value="6aad">6aad</option>
      <option value="7aad">7aad</option>
      <option value="8aad">8aad</option>
      <option value="F1">F1</option>
      <option value="F2">F2</option>
      <option value="F3">F3</option>
      <option value="F4">F4</option>
    </select>
  `;
  studentInputsDiv.appendChild(div);
}

document.getElementById('studentForm').addEventListener('submit', function(e){
  e.preventDefault();

  const parentName = document.getElementById('parentName').value.trim();
  const discountValue = parseFloat(document.getElementById('discountAmount').value) || 0;

  const studentNames = document.querySelectorAll('.student-name-input');
  const classSelects = document.querySelectorAll('.class-select');

  let totalAmount = 0;
  const studentsListDiv = document.getElementById('studentsList');
  studentsListDiv.innerHTML = "";

  // Collect student data
  for(let i=0; i<maxStudents; i++){
    const name = studentNames[i].value.trim();
    const cls = classSelects[i].value;

    if(name && cls){
      const price = classPrices[cls] || 0;
      totalAmount += price;

      const color = colors[i % colors.length];

      const studentBox = document.createElement('div');
      studentBox.className = "student-box";
      studentBox.style.backgroundColor = color;
      studentBox.innerHTML = `<span class="student-name">${name}</span> <span class="student-parent">${parentName}</span> <span class="student-class">${cls}</span>`;

      studentsListDiv.appendChild(studentBox);
    }
  }

  // Subtract discount
  let finalAmount = totalAmount - discountValue;
  if(finalAmount < 0) finalAmount = 0;

  document.getElementById('totalText').innerText = `*789*123456*${finalAmount}#`;
  document.getElementById('receiptOutput').classList.remove('d-none');
});

function printReceipt() {
  const printButton = document.getElementById('printButton');
  printButton.style.display = 'none';
  window.print();
  location.reload();
}
</script>
</body>
</html>
